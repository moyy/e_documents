- [Astc 尺寸 & 性能 & 质量](#astc-尺寸--性能--质量)
  - [1. 背景 & 用例](#1-背景--用例)
    - [1.1. 电脑配置](#11-电脑配置)
    - [1.2. 测试图片](#12-测试图片)
  - [2. 背景](#2-背景)
  - [3. C++ exe的 解码时间](#3-c-exe的-解码时间)
  - [4. Rust 的 解码时间](#4-rust-的-解码时间)
  - [5. Rust 用 wasm-bindgen 的 wasm](#5-rust-用-wasm-bindgen-的-wasm)
  - [6. Rust 用 stdweb-asm.js](#6-rust-用-stdweb-asmjs)
  - [7. Android 华为 Mate30 小游戏 stdweb-asm.js](#7-android-华为-mate30-小游戏-stdweb-asmjs)

# Astc 尺寸 & 性能 & 质量

## 1. 背景 & 用例

### 1.1. 电脑配置

![](../img/m_bafa6d484a1314ddc41d4d766a3f47d9_r.png)

### 1.2. 测试图片

* 文件名：1280_1024.jpg，分辨率：1280*1024
![](../img/m_34e82b6095b8b0eab742474886757b39_r.png)
* 文件名：179_268.jpg，分辨率：179*268
![](../img/m_a5c2c37eaed4555352ba48351bc7943d_r.png)

## 2. 背景

* X64指令集，Release版本；
* 在没有SIMD指令集的情况，单线程下；

像素尺寸：1280 * 1024 是 179 * 268 的：27.3 倍

## 3. C++ exe的 解码时间

* 5 ms * 27.3 = 136.5 ms
* 5 ms * 27.3 = 136.5 ms

||4*4像素/块|8*8像素/块|12*12像素/块|
|--|--|--|--|
|图片尺寸 179 * 268|4-6毫秒|4-6毫秒|4-6毫秒|
|图片尺寸 1280 * 1024|114-119毫秒|99-105毫秒|101-104毫秒|

## 4. Rust 的 解码时间

* 2.5 ms * 27.3 = 68.25 ms
* 1.9 ms * 27.3 = 51.87 ms

||4*4像素/块|8*8像素/块|
|--|--|--|
|图片尺寸 179 * 268|2.4-3.0 毫秒|1.7-2.1 毫秒|
|图片尺寸 1280 * 1024|65-69 毫秒|49-53 毫秒|

## 5. Rust 用 wasm-bindgen 的 wasm

||4*4像素/块|8*8像素/块|
|--|--|--|
|图片尺寸 179 * 268|12 毫秒|8 毫秒|
|图片尺寸 1280 * 1024| 278 + 15 毫秒| 194 + 15毫秒|

## 6. Rust 用 stdweb-asm.js

下面的时间：解码时间 + 分配和拷贝wasm input、output堆 时间；

+ 5 ms * 27.3 = 136.5 ms;
+ 8 ms * 27.3 = 218.4 ms;

||4*4像素/块|8*8像素/块|
|--|--|--|
|图片尺寸 179 * 268|8 毫秒|5 毫秒|
|图片尺寸 1280 * 1024| 195 - 200 毫秒| 131 - 138 毫秒|

## 7. Android 华为 Mate30 小游戏 stdweb-asm.js

||4*4像素/块|8*8像素/块|
|--|--|--|
|图片尺寸 179 * 268| 9 毫秒| 7 毫秒|
|图片尺寸 1280 * 1024| 236 - 242 毫秒| 165 毫秒|